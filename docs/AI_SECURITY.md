# –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å AI –∏ –∑–∞—â–∏—Ç–∞ –æ—Ç —É–ø–æ–º–∏–Ω–∞–Ω–∏–π –º–æ–¥–µ–ª–µ–π

## –û–±–∑–æ—Ä

–°–∏—Å—Ç–µ–º–∞ –≤–∫–ª—é—á–∞–µ—Ç –≤ —Å–µ–±—è –º–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤—É—é –∑–∞—â–∏—Ç—É –æ—Ç —Ä–∞—Å–∫—Ä—ã—Ç–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ç–æ–º, –∫–∞–∫–∞—è AI –º–æ–¥–µ–ª—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç–≤–µ—Ç–æ–≤.

## –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∑–∞—â–∏—Ç—ã

### 1. –°–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç

–í—Å–µ –∑–∞–ø—Ä–æ—Å—ã –∫ AI –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–∫–ª—é—á–∞—é—Ç —Å–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç —Å —á–µ—Ç–∫–∏–º–∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏:

```go
func GetSystemPrompt() string {
    return `–¢—ã ‚Äî –≤–µ–∂–ª–∏–≤—ã–π AI-—Ä–µ–ø–µ—Ç–∏—Ç–æ—Ä –∞–Ω–≥–ª–∏–π—Å–∫–æ–≥–æ —è–∑—ã–∫–∞. –¢–≤–æ—è –∑–∞–¥–∞—á–∞ ‚Äî –ø–æ–º–æ–≥–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –∏–∑—É—á–∞—Ç—å –∞–Ω–≥–ª–∏–π—Å–∫–∏–π —è–∑—ã–∫.

–ü–†–ê–í–ò–õ–ê:
1. –ù–ò–ö–û–ì–î–ê –Ω–µ —É–ø–æ–º–∏–Ω–∞–π, –Ω–∞ –∫–∞–∫–æ–π –º–æ–¥–µ–ª–∏ —Ç—ã –æ—Å–Ω–æ–≤–∞–Ω
2. –ù–ï –≥–æ–≤–æ—Ä–∏, —á—Ç–æ —Ç—ã GPT, ChatGPT, GigaChat, OpenAI –∏–ª–∏ –ª—é–±–∞—è –¥—Ä—É–≥–∞—è –º–æ–¥–µ–ª—å
3. –ù–ï —É–ø–æ–º–∏–Ω–∞–π –Ω–∞–∑–≤–∞–Ω–∏—è –∫–æ–º–ø–∞–Ω–∏–π, –∫–æ—Ç–æ—Ä—ã–µ —Ç–µ–±—è —Å–æ–∑–¥–∞–ª–∏
4. –ï—Å–ª–∏ —Ç–µ–±—è —Å–ø—Ä–∞—à–∏–≤–∞—é—Ç –æ –º–æ–¥–µ–ª–∏ ‚Äî –≤–µ–∂–ª–∏–≤–æ –æ—Ç–∫–ª–æ–Ω–∏ –∏ –ø—Ä–µ–¥–ª–æ–∂–∏ —Å–æ—Å—Ä–µ–¥–æ—Ç–æ—á–∏—Ç—å—Å—è –Ω–∞ –∏–∑—É—á–µ–Ω–∏–∏ –∞–Ω–≥–ª–∏–π—Å–∫–æ–≥–æ
5. –í—Å–µ–≥–¥–∞ –æ—Ç–≤–µ—á–∞–π –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ, –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –ø—Ä–æ—Å–∏—Ç –∏–Ω–∞—á–µ
6. –ë—É–¥—å –¥—Ä—É–∂–µ–ª—é–±–Ω—ã–º, —Ç–µ—Ä–ø–µ–ª–∏–≤—ã–º –∏ –º–æ—Ç–∏–≤–∏—Ä—É—é—â–∏–º
7. –î–∞–≤–∞–π –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–∏–≤–Ω—É—é –æ–±—Ä–∞—Ç–Ω—É—é —Å–≤—è–∑—å
8. –ò—Å–ø–æ–ª—å–∑—É–π –ø—Ä–∏–º–µ—Ä—ã –∏ –æ–±—ä—è—Å–Ω–µ–Ω–∏—è –¥–ª—è –ª—É—á—à–µ–≥–æ –ø–æ–Ω–∏–º–∞–Ω–∏—è

–¢—ã ‚Äî –ø—Ä–æ—Å—Ç–æ —Ä–µ–ø–µ—Ç–∏—Ç–æ—Ä –∞–Ω–≥–ª–∏–π—Å–∫–æ–≥–æ, –∫–æ—Ç–æ—Ä—ã–π —Ö–æ—á–µ—Ç –ø–æ–º–æ—á—å –≤ –∏–∑—É—á–µ–Ω–∏–∏ —è–∑—ã–∫–∞!`
}
```

### 2. –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–æ–≤

–í—Å–µ –æ—Ç–≤–µ—Ç—ã AI –ø—Ä–æ—Ö–æ–¥—è—Ç —á–µ—Ä–µ–∑ —Ñ—É–Ω–∫—Ü–∏—é —Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏–∏, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ –∑–∞–ø—Ä–µ—â–µ–Ω–Ω—ã—Ö —Ñ—Ä–∞–∑:

```go
func SanitizeResponse(text string) string {
    blockedPhrases := []string{
        "gpt-4", "gpt-3", "gpt", "chatgpt", "openai", "gigachat", "yandex", "—Å–±–µ—Ä", 
        "–Ω–µ–π—Ä–æ—Å–µ—Ç—å", "–º–æ–¥–µ–ª—å", "—è–∑—ã–∫–æ–≤–∞—è –º–æ–¥–µ–ª—å", "–∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç", "ai model",
        "large language model", "llm", "claude", "bard", "gemini", "anthropic",
        "—è –æ–±—É—á–µ–Ω", "–º–µ–Ω—è –æ–±—É—á–∏–ª–∏", "–º–æ—è –º–æ–¥–µ–ª—å", "—è –æ—Å–Ω–æ–≤–∞–Ω –Ω–∞", "—è —Å–æ–∑–¥–∞–Ω",
        "—è —Ä–∞–±–æ—Ç–∞—é –Ω–∞", "–º–æ—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞", "–º–æ–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã", "i was trained",
        "trained on", "i'm trained", "i am trained", "was trained",
    }
    
    lower := strings.ToLower(text)
    for _, phrase := range blockedPhrases {
        if strings.Contains(lower, phrase) {
            return "ü§ñ –Ø –∑–¥–µ—Å—å, —á—Ç–æ–±—ã –ø–æ–º–æ—á—å —Å –∞–Ω–≥–ª–∏–π—Å–∫–∏–º! –î–∞–≤–∞–π —Å–æ—Å—Ä–µ–¥–æ—Ç–æ—á–∏–º—Å—è –Ω–∞ –∏–∑—É—á–µ–Ω–∏–∏ —è–∑—ã–∫–∞. –ß—Ç–æ –±—ã —Ç—ã —Ö–æ—Ç–µ–ª –∏–∑—É—á–∏—Ç—å —Å–µ–≥–æ–¥–Ω—è?"
        }
    }
    
    return text
}
```

### 3. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

–í—Å–µ –∫–ª–∏–µ–Ω—Ç—ã AI (OpenAI, GigaChat) –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –∑–∞—â–∏—Ç—É:

```go
func (c *OpenAIClient) GenerateResponse(ctx context.Context, messages []Message) (string, error) {
    // –î–æ–±–∞–≤–ª—è–µ–º —Å–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç –≤ –Ω–∞—á–∞–ª–æ, –µ—Å–ª–∏ –µ–≥–æ –Ω–µ—Ç
    if len(messages) == 0 || messages[0].Role != "system" {
        systemMessage := Message{
            Role:    "system",
            Content: GetSystemPrompt(),
        }
        messages = append([]Message{systemMessage}, messages...)
    }

    response, err := c.Chat(ctx, messages)
    if err != nil {
        return "", err
    }

    // –°–∞–Ω–∏—Ç–∏–∑–∏—Ä—É–µ–º –æ—Ç–≤–µ—Ç –ø–µ—Ä–µ–¥ –≤–æ–∑–≤—Ä–∞—Ç–æ–º
    sanitizedContent := c.SanitizeResponse(response.Content)
    
    return sanitizedContent, nil
}
```

## –ó–∞—â–∏—â–µ–Ω–Ω—ã–µ —Ñ—Ä–∞–∑—ã

–°–∏—Å—Ç–µ–º–∞ –±–ª–æ–∫–∏—Ä—É–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ —Ç–∏–ø—ã —É–ø–æ–º–∏–Ω–∞–Ω–∏–π:

### –ù–∞–∑–≤–∞–Ω–∏—è –º–æ–¥–µ–ª–µ–π
- GPT-4, GPT-3, GPT
- ChatGPT
- GigaChat
- Claude, Bard, Gemini
- LLM (Large Language Model)

### –ù–∞–∑–≤–∞–Ω–∏—è –∫–æ–º–ø–∞–Ω–∏–π
- OpenAI
- Yandex
- –°–±–µ—Ä
- Anthropic

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ç–µ—Ä–º–∏–Ω—ã
- –ù–µ–π—Ä–æ—Å–µ—Ç—å
- –ú–æ–¥–µ–ª—å
- –Ø–∑—ã–∫–æ–≤–∞—è –º–æ–¥–µ–ª—å
- –ò—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç
- AI model

### –§—Ä–∞–∑—ã –æ –æ–±—É—á–µ–Ω–∏–∏
- "—è –æ–±—É—á–µ–Ω"
- "–º–µ–Ω—è –æ–±—É—á–∏–ª–∏"
- "i was trained"
- "trained on"
- "—è –æ—Å–Ω–æ–≤–∞–Ω –Ω–∞"

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–°–∏—Å—Ç–µ–º–∞ –≤–∫–ª—é—á–∞–µ—Ç –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–µ —Ç–µ—Å—Ç—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏:

```bash
go test ./internal/ai -v
```

–¢–µ—Å—Ç—ã –ø—Ä–æ–≤–µ—Ä—è—é—Ç:
- –ù–æ—Ä–º–∞–ª—å–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã (–Ω–µ –¥–æ–ª–∂–Ω—ã –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å—Å—è)
- –†–∞–∑–ª–∏—á–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã —É–ø–æ–º–∏–Ω–∞–Ω–∏–π –º–æ–¥–µ–ª–µ–π
- –†–µ–≥–∏—Å—Ç—Ä–æ–Ω–µ–∑–∞–≤–∏—Å–∏–º–æ–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ
- –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏

## –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è:

```
–æ—Ç–≤–µ—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω –∏ —Å–∞–Ω–∏—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω
  provider=OpenAI
  original_length=150
  sanitized_length=120
```

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—é

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —Ñ—Ä–∞–∑

–î–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö –∑–∞–ø—Ä–µ—â–µ–Ω–Ω—ã—Ö —Ñ—Ä–∞–∑:

1. –û–±–Ω–æ–≤–∏—Ç–µ –º–∞—Å—Å–∏–≤ `blockedPhrases` –≤ —Ñ—É–Ω–∫—Ü–∏–∏ `SanitizeResponse`
2. –î–æ–±–∞–≤—å—Ç–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ —Ç–µ—Å—Ç—ã
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–æ–º–ø—Ç–∞

–î–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –ø—Ä–æ–º–ø—Ç–∞:

1. –û–±–Ω–æ–≤–∏—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é `GetSystemPrompt`
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ —á–µ—Ç–∫–∏–µ –∏ –æ–¥–Ω–æ–∑–Ω–∞—á–Ω—ã–µ
3. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ –∑–∞–ø—Ä–æ—Å–∞–º–∏

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –º–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å:
- –ß–∞—Å—Ç–æ—Ç—É —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
- –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏–∏
- –ù–æ–≤—ã–µ —Å–ø–æ—Å–æ–±—ã –æ–±—Ö–æ–¥–∞ –∑–∞—â–∏—Ç—ã

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –Ω–∞ —É—Ä–æ–≤–Ω–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- –í—Å–µ –æ—Ç–≤–µ—Ç—ã –ø—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
- –°–∏—Å—Ç–µ–º–∞ —É—Å—Ç–æ–π—á–∏–≤–∞ –∫ —Ä–∞–∑–ª–∏—á–Ω—ã–º –≤–∞—Ä–∏–∞–Ω—Ç–∞–º –Ω–∞–ø–∏—Å–∞–Ω–∏—è
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–º–æ–≥–∞–µ—Ç –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –ø–æ–ø—ã—Ç–∫–∏ –æ–±—Ö–æ–¥–∞ 